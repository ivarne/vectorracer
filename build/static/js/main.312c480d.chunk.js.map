{"version":3,"sources":["components/Infrastructure/Grid.jsx","components/Infrastructure/CurrentPos.jsx","components/Infrastructure/NextPos.jsx","components/Infrastructure/Trace.jsx","components/Infrastructure/StopLine.jsx","components/Infrastructure/Walls.jsx","utils/intersect.js","components/Infrastructure/Game.jsx","App.js","registerServiceWorker.js","index.js"],"names":["Grid","_this$props","this","props","size_x","size_y","vertical","concat","repeat","horizontal","react_default","a","createElement","className","d","PureComponent","CurrentPos","x","y","cx","cy","r","NextPos","delta_x","delta_y","common","Object","assign","Trace","trace","join","map","pos","i","key","StopLine","p","sign","Math","abs","s","delta_p","_sum","x_limit","y_limit","getStops","Walls","walls","wall","type","objectWithoutProperties","React","intersect","line","height","width","intersect_segment","intersect_rect","Error","line1","line2","_line","slicedToArray","_line$","A1x","A1y","_line$2","A2x","A2y","_line2","_line2$","B1x","B1y","_line2$2","B2x","B2y","Game","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","updatePos","setState","isValidNextPos","toConsumableArray","handleClick","event","pt","svg","createSVGPoint","clientX","clientY","cursopt","matrixTransform","getScreenCTM","inverse","round","goBack","state","length","newTrace","slice","delta","lastpos","initial_x","initial_y","some","_this2","onClick","viewBox","ref","Infrastructure_Grid","Infrastructure_Walls","Infrastructure_Trace","Infrastructure_CurrentPos","Infrastructure_StopLine","Infrastructure_NextPos","App","components_Infrastructure_Game","Component","isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","catch","error","ReactDOM","render","src_App_0","document","getElementById","URL","process","origin","addEventListener","fetch","response","status","headers","get","indexOf","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.312c480d.chunk.js","sourcesContent":["import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\n\nclass Grid extends PureComponent {\n  static propTypes = {\n    size_x: PropTypes.number,\n    size_y: PropTypes.number\n  };\n  render() {\n    const { size_x, size_y } = this.props;\n    const vertical = ` l 0 ${size_y} m 1 -${size_y}`.repeat(size_x + 1);\n    const horizontal = ` l ${size_x} 0 m -${size_x} 1`.repeat(size_y + 1);\n    return (\n      <g className=\"Grid\">\n        <path d={\"M 0 0 \" + vertical + \"M 0 0\" + horizontal} />\n      </g>\n    );\n  }\n}\n\nexport default Grid;\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\n\n//import './CurrentPos.css'\n\nclass CurrentPos extends PureComponent {\n  static propTypes = {};\n  render() {\n    const { x, y } = this.props;\n    return (\n      <g className=\"CurrentPos\">\n        <circle cx={x} cy={y} r={0.5} />\n      </g>\n    );\n  }\n}\n\nexport default CurrentPos;\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\n\n//import './NextPos.css'\n\nclass NextPos extends PureComponent {\n  static propTypes = {};\n\n  render() {\n    const { x, delta_x, y, delta_y } = this.props;\n    const common = {\n      r: 0.45\n    };\n    return (\n      <g className=\"NextPos\">\n        <circle cx={x + delta_x + 1} cy={y + delta_y + 1} {...common} />\n        <circle cx={x + delta_x + 0} cy={y + delta_y + 1} {...common} />\n        <circle cx={x + delta_x - 1} cy={y + delta_y + 1} {...common} />\n        <circle cx={x + delta_x + 1} cy={y + delta_y + 0} {...common} />\n        <circle cx={x + delta_x + 0} cy={y + delta_y + 0} {...common} />\n        <circle cx={x + delta_x - 1} cy={y + delta_y + 0} {...common} />\n        <circle cx={x + delta_x + 1} cy={y + delta_y - 1} {...common} />\n        <circle cx={x + delta_x + 0} cy={y + delta_y - 1} {...common} />\n        <circle cx={x + delta_x - 1} cy={y + delta_y - 1} {...common} />\n      </g>\n    );\n  }\n}\n\nexport default NextPos;\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\n\n//import './Trace.css'\n\nclass Trace extends PureComponent {\n  static propTypes = {\n    trace: PropTypes.arrayOf(\n      PropTypes.arrayOf(PropTypes.number.isRequired).isRequired\n    ).isRequired\n  };\n  render() {\n    const { trace } = this.props;\n    return (\n      <g className=\"Trace\">\n        <path d={\"M\" + trace.join(\"L\")} />\n        {trace.map((pos, i) => (\n          <circle cx={pos[0]} cy={pos[1]} r=\"0.2\" key={i} />\n        ))}\n      </g>\n    );\n  }\n}\n\nexport default Trace;\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\n\n//import './StopLine.css'\n\nclass StopLine extends PureComponent {\n  static propTypes = {\n    x: PropTypes.number.isRequired,\n    y: PropTypes.number.isRequired,\n    delta_x: PropTypes.number.isRequired,\n    delta_y: PropTypes.number.isRequired,\n    size_x: PropTypes.number.isRequired,\n    size_y: PropTypes.number.isRequired\n  };\n  _sum(p) {\n    const sign = Math.sign(p);\n    p = Math.abs(p);\n    let s = 0;\n    while (p > 0) {\n      s += p;\n      p--;\n    }\n    return s * sign;\n  }\n  getStops(p, delta_p) {\n    return [\n      p + this._sum(delta_p - 1),\n      p + this._sum(delta_p),\n      p + this._sum(delta_p + 1)\n    ];\n  }\n  render() {\n    const { x, y, delta_x, delta_y, size_x, size_y } = this.props;\n    //if (delta_x < 4 && delta_y < 4) return null;\n    let x_limit, y_limit;\n    if (Math.abs(delta_x) > 2) {\n      x_limit = this.getStops(x, delta_x).map((s, i) => (\n        <path d={`M${s} 0 l0 ${size_x}`} className={\"stop\" + i} key={i} />\n      ));\n    }\n    if (Math.abs(delta_y) > 2) {\n      y_limit = this.getStops(y, delta_y).map((s, i) => (\n        <path d={`M0 ${s} l${size_y} 0`} className={\"stop\" + i} key={i} />\n      ));\n    }\n    return (\n      <g className=\"StopLine\">\n        {x_limit}\n        {y_limit}\n      </g>\n    );\n  }\n}\n\nexport default StopLine;\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\n\n//import './Walls.css'\n\nclass Walls extends PureComponent {\n  static propTypes = {\n    walls: PropTypes.arrayOf(\n      PropTypes.shape({ type: PropTypes.oneOf([\"rect\"]) })\n    ).isRequired\n  };\n  render() {\n    const { walls } = this.props;\n    return (\n      <g className=\"Walls\">\n        {walls.map((wall, i) => {\n          const { type, ...props } = wall;\n          props.key = i;\n          return React.createElement(type, props);\n        })}\n      </g>\n    );\n  }\n}\n\nexport default Walls;\n","export function intersect(wall, line) {\n  switch (wall.type) {\n    case \"rect\":\n      return intersect_rect(wall, line);\n    default:\n      throw new Error(`unknown wall type: ${wall.type}`);\n  }\n}\n\nfunction intersect_rect(wall, line) {\n  const { x, y, height, width } = wall;\n  return (\n    intersect_segment([[x, y], [x + width, y]], line) ||\n    intersect_segment([[x, y + height], [x + width, y + height]], line) ||\n    intersect_segment([[x, y], [x, y + height]], line) ||\n    intersect_segment([[x + width, y], [x + width, y + height]], line)\n  );\n}\nfunction intersect_segment(line1, line2) {\n  // Two lines AB and CD\n  const [[A1x, A1y], [A2x, A2y]] = line1;\n  const [[B1x, B1y], [B2x, B2y]] = line2;\n  // Check bounding boxes\n  if (!(A1x <= B2x && A2x >= B1x && A1y <= B2y && A2y >= B1y)) return false;\n  return true;\n}\n","import React, { PureComponent } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Grid from \"./Grid\";\nimport CurrentPos from \"./CurrentPos\";\nimport NextPos from \"./NextPos\";\n\nimport \"./Game.css\";\nimport Trace from \"./Trace\";\nimport StopLine from \"./StopLine\";\nimport Walls from \"./Walls\";\nimport { intersect } from \"../../utils/intersect\";\n\nconst walls = [\n  {\n    type: \"rect\",\n    x: 10,\n    y: 10,\n    height: 30,\n    width: 30\n  }\n];\n\nclass Game extends PureComponent {\n  static propTypes = {\n    size_x: PropTypes.number.isRequired,\n    size_y: PropTypes.number.isRequired,\n    initial_x: PropTypes.number.isRequired,\n    initial_y: PropTypes.number.isRequired\n  };\n  constructor(props) {\n    super(props);\n    this.state = {\n      x: props.initial_x,\n      y: props.initial_y,\n      delta_x: 0,\n      delta_y: 0,\n      trace: [[props.initial_x, props.initial_y]],\n      walls: walls\n    };\n  }\n  isValidNextPos(x, y) {\n    const s = this.state;\n    if (x > s.x + s.delta_x + 1 || x < s.x + s.delta_x - 1) return false;\n    if (y > s.y + s.delta_y + 1 || y < s.y + s.delta_y - 1) return false;\n    return !s.walls.some(wall => intersect(wall, [[s.x, s.y], [x, y]]));\n    return true; // TODO; check wals\n  }\n  updatePos = (x, y) => {\n    this.setState(s => {\n      if (!this.isValidNextPos(x, y)) return {};\n      return {\n        trace: [...s.trace, [x, y]],\n        x,\n        y,\n        delta_x: x - s.x,\n        delta_y: y - s.y\n      };\n    });\n  };\n  handleClick = event => {\n    const pt = this.svg.createSVGPoint();\n    pt.x = event.clientX;\n    pt.y = event.clientY;\n    const cursopt = pt.matrixTransform(this.svg.getScreenCTM().inverse());\n\n    this.updatePos(Math.round(cursopt.x), Math.round(cursopt.y));\n  };\n  goBack = event => {\n    if (this.state.trace.length < 2) return;\n    this.setState(s => {\n      const newTrace = s.trace.slice(0, -1);\n      const pos = newTrace[newTrace.length - 1];\n      let delta = [0, 0];\n      if (newTrace.length > 1) {\n        const lastpos = newTrace[newTrace.length - 2];\n        delta = [pos[0] - lastpos[0], pos[1] - lastpos[1]];\n      }\n      return {\n        trace: newTrace,\n        x: pos[0],\n        y: pos[1],\n        delta_x: delta[0],\n        delta_y: delta[1]\n      };\n    });\n  };\n\n  render() {\n    const { size_x, size_y } = this.props;\n    return (\n      <div className=\"Game\">\n        <h1>Vectorracer{this.state.trace.length}</h1>\n        <button onClick={this.goBack}>Undo</button>\n        <svg\n          className=\"Game\"\n          viewBox={`-2 -2 ${size_x + 4} ${size_y + 4}`}\n          onClick={this.handleClick}\n          ref={ref => {\n            this.svg = ref;\n          }}\n        >\n          <Grid size_x={size_x} size_y={size_y} />\n          <Walls walls={walls} />\n          <Trace trace={this.state.trace} />\n          <CurrentPos {...this.state} />\n          <StopLine {...this.state} {...this.props} />\n          <NextPos {...this.state} />\n        </svg>\n      </div>\n    );\n  }\n}\n\nexport default Game;\n","import React, { Component } from \"react\";\nimport \"./App.css\";\nimport Game from \"./components/Infrastructure/Game\";\n\nclass App extends Component {\n  render() {\n    const gameProps = {\n      size_x: 50,\n      size_y: 50,\n      initial_x: 5,\n      initial_y: 5\n    };\n    return (\n      <div className=\"App\">\n        <Game {...gameProps} />;\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n"],"sourceRoot":""}